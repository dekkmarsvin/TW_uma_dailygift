# UMA Daily Gift Automation

è‡ªå‹•åŒ–é ˜å– UMA ç¶²ç«™ (uma.komoejoy.com) æ¯æ—¥ç°½åˆ°çå‹µçš„ Node.js æ‡‰ç”¨ç¨‹å¼ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- âœ… **è‡ªå‹•ç™»å…¥** - Cookie è‡ªå‹•ä¿å­˜/è¼‰å…¥ï¼Œé¿å…æ¯æ¬¡æ‰‹å‹•ç™»å…¥
- âœ… **æ™ºèƒ½é©—è­‰ç¢¼è­˜åˆ¥** - ä½¿ç”¨ Google Gemini AI è‡ªå‹•è­˜åˆ¥é©—è­‰ç¢¼ï¼ˆå«é‡è©¦æ©Ÿåˆ¶ï¼‰
- âœ… **æ¯æ—¥ç°½åˆ°** - è‡ªå‹•é»æ“Šç°½åˆ°æŒ‰éˆ•é ˜å–çå‹µ
- âœ… **è‡ªå‹•æŠ½ç** - ç•¶ç©åˆ†é”åˆ° 100 åˆ†ä¸”æœ‰çå“åº«å­˜æ™‚è‡ªå‹•åƒèˆ‡æŠ½ç
- âœ… **Windows é€šçŸ¥** - å¤±æ•—æ™‚å½ˆå‡ºæé†’è¦–çª—é€šçŸ¥ä½¿ç”¨è€…
- âœ… **æ¯æ—¥æ‘˜è¦æ—¥èªŒ** - çµæ§‹åŒ–è¨˜éŒ„æ¯æ—¥ç°½åˆ°ã€ç©åˆ†ã€æŠ½ççµæœ
- âœ… **å®Œæ•´æ—¥èªŒç³»çµ±** - æŠ€è¡“æ—¥èªŒ (activity.log) + ä½¿ç”¨è€…å‹å–„æ‘˜è¦ (daily-summary.log)

## ğŸ“‹ éœ€æ±‚

- **Node.js** >= 16.0.0
- **npm** >= 7.0.0
- **Windows** OS (for notifications)
- **Google Gemini API Key** ([ç”³è«‹é€£çµ](https://aistudio.google.com/app/apikey))

## ğŸš€ å®‰è£æ­¥é©Ÿ

### 1. Clone å°ˆæ¡ˆ

```bash
git clone https://github.com/your-username/TW_uma_dailygift.git
cd TW_uma_dailygift
```

### 2. å®‰è£ä¾è³´

```bash
npm install
npx playwright install
```

### 3. è¨­å®šç’°å¢ƒè®Šæ•¸

è¤‡è£½ `.env.example` ç‚º `.env`ï¼š

```bash
copy .env.example .env
```

ç·¨è¼¯ `.env` ä¸¦å¡«å…¥æ‚¨çš„è³‡è¨Šï¼š

```env
login_username=your_email@example.com
login_password=your_password_here
GEMINI_API_KEY=your_gemini_api_key_here
model=gemini-1.5-flash
```

**é‡è¦**: è«‹ç¢ºä¿ `.env` æª”æ¡ˆå®‰å…¨ï¼Œä¸è¦æäº¤è‡³ Gitï¼

### 4. å–å¾— Gemini API Key

1. å‰å¾€ [Google AI Studio](https://aistudio.google.com/app/apikey)
2. ç™»å…¥ Google å¸³è™Ÿ
3. é»æ“Š "Create API Key"
4. å°‡ API Key è¤‡è£½åˆ° `.env` çš„ `GEMINI_API_KEY`

## ğŸ’» ä½¿ç”¨æ–¹å¼

### æ‰‹å‹•åŸ·è¡Œ

```bash
node src/automation.js
```

### Windows æ’ç¨‹åŸ·è¡Œ

è«‹åƒé–± [SETUP_SCHEDULER.md](SETUP_SCHEDULER.md) è¨­å®š Windows å·¥ä½œæ’ç¨‹å™¨ã€‚

å»ºè­°è¨­å®šï¼šæ¯å¤©ä¸Šåˆ 9:00 è‡ªå‹•åŸ·è¡Œ

## ğŸ“Š æ—¥èªŒæª”æ¡ˆ

### activity.log
æŠ€è¡“å±¤ç´šçš„è©³ç´°æ—¥èªŒï¼ŒåŒ…å«ï¼š
- æ‰€æœ‰æ“ä½œæ­¥é©Ÿ
- éŒ¯èª¤è¨Šæ¯èˆ‡å †ç–Šè¿½è¹¤
- é™¤éŒ¯è³‡è¨Š

ä½ç½®: `logs/activity.log`

### daily-summary.log
ä½¿ç”¨è€…å‹å–„çš„æ¯æ—¥æ‘˜è¦ï¼ŒåŒ…å«ï¼š
- âœ… ç°½åˆ°ç‹€æ…‹èˆ‡ç´¯ç©å¤©æ•¸
- ğŸ’° ç©åˆ†è³‡è¨Šï¼ˆæœ¬å¹´åº¦ + å³å°‡éæœŸ + ç¸½è¨ˆï¼‰
- ğŸ° æŠ½ççµæœ
- ğŸ“Š åŸ·è¡Œæ‘˜è¦ï¼ˆç™»å…¥æ–¹å¼ã€é©—è­‰ç¢¼ã€åŸ·è¡Œæ™‚é–“ï¼‰

ä½ç½®: `logs/daily-summary.log`

ç¯„ä¾‹ï¼š
```
====================================================
2026-02-04
====================================================
âœ… Check-in: Success
   - Days checked: 3 â†’ 4
   - Reward: Daily Bonus

ğŸ’° Points:
   - Current year: 40
   - Expiring: 40
   - Total: 80

ğŸ° Lottery: Skipped
   - Points insufficient (80/100)

ğŸ“Š Summary:
   - Login: Auto (Cookie)
   - CAPTCHA: Not required
   - Duration: 15s
====================================================
```

### scheduler.log
PowerShell æ’ç¨‹è…³æœ¬çš„åŸ·è¡Œæ—¥èªŒ

ä½ç½®: `logs/scheduler.log`

## ğŸ”” é€šçŸ¥ç³»çµ±

ç•¶ç™¼ç”Ÿä»¥ä¸‹æƒ…æ³æ™‚ï¼Œç³»çµ±æœƒå½ˆå‡º Windows é€šçŸ¥è¦–çª—ï¼š

- âš ï¸ **CAPTCHA è­˜åˆ¥å¤±æ•—** - éœ€è¦æ‰‹å‹•è¼¸å…¥é©—è­‰ç¢¼
- âŒ **ç™»å…¥å¤±æ•—** - å¸³è™Ÿå¯†ç¢¼å¯èƒ½éŒ¯èª¤
- âŒ **åŸ·è¡ŒéŒ¯èª¤** - ç™¼ç”Ÿåš´é‡éŒ¯èª¤

## ğŸ› ï¸ å°ˆæ¡ˆçµæ§‹

```
TW_uma_dailygift/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ automation.js          # ä¸»è¦è‡ªå‹•åŒ–é‚è¼¯
â”‚   â”œâ”€â”€ config.js              # è¨­å®šæª”
â”‚   â”œâ”€â”€ logger.js              # æ—¥èªŒç³»çµ±
â”‚   â””â”€â”€ dailySummaryLogger.js  # æ¯æ—¥æ‘˜è¦æ—¥èªŒ
â”œâ”€â”€ logs/
â”‚   â”œâ”€â”€ activity.log           # æŠ€è¡“æ—¥èªŒ
â”‚   â”œâ”€â”€ daily-summary.log      # æ¯æ—¥æ‘˜è¦
â”‚   â””â”€â”€ scheduler.log          # æ’ç¨‹æ—¥èªŒ
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ function_io.md         # å‡½æ•¸ I/O æ–‡ä»¶
â”œâ”€â”€ goal/
â”‚   â””â”€â”€ goal.md                # å°ˆæ¡ˆç›®æ¨™
â”œâ”€â”€ run_automation.ps1         # PowerShell è‡ªå‹•åŒ–è…³æœ¬
â”œâ”€â”€ .env.example               # ç’°å¢ƒè®Šæ•¸ç¯„æœ¬
â”œâ”€â”€ .env                       # ç’°å¢ƒè®Šæ•¸ (éœ€è‡ªè¡Œå»ºç«‹)
â””â”€â”€ cookies.json               # ç™»å…¥ Cookie (è‡ªå‹•ç”Ÿæˆ)
```

## ğŸ”§ ç–‘é›£æ’è§£

### é©—è­‰ç¢¼è­˜åˆ¥å¤±æ•—

**ç—‡ç‹€**: é€£çºŒ 3 æ¬¡ç„¡æ³•è­˜åˆ¥é©—è­‰ç¢¼

**è§£æ±ºæ–¹æ¡ˆ**:
1. ç¢ºèª Gemini API Key æ­£ç¢º
2. æª¢æŸ¥ API é…é¡æ˜¯å¦ç”¨ç›¡
3. æ‰‹å‹•è¼¸å…¥é©—è­‰ç¢¼ï¼ˆç³»çµ±æœƒç­‰å¾… 30 ç§’ï¼‰

### ç™»å…¥å¤±æ•—

**ç—‡ç‹€**: é¡¯ç¤º "ç™»å…¥å¤±æ•—" é€šçŸ¥

**è§£æ±ºæ–¹æ¡ˆ**:
1. æª¢æŸ¥ `.env` ä¸­çš„å¸³è™Ÿå¯†ç¢¼æ˜¯å¦æ­£ç¢º
2. ç¢ºèªç¶²ç«™å¯æ­£å¸¸è¨ªå•
3. åˆªé™¤ `cookies.json` å¼·åˆ¶é‡æ–°ç™»å…¥

### Cookie éæœŸ

**ç—‡ç‹€**: æ˜æ˜æœ‰ `cookies.json` ä½†ä»éœ€ç™»å…¥

**è§£æ±ºæ–¹æ¡ˆ**:
- æ­£å¸¸æƒ…æ³ï¼ŒCookie æœƒè‡ªå‹•æ›´æ–°
- å¦‚æŒçºŒç™¼ç”Ÿï¼Œè«‹åˆªé™¤ `cookies.json` é‡æ–°ç™»å…¥

### æ’ç¨‹æœªåŸ·è¡Œ

**ç—‡ç‹€**: Windows æ’ç¨‹è¨­å®šå¾Œæ²’æœ‰è‡ªå‹•åŸ·è¡Œ

**è§£æ±ºæ–¹æ¡ˆ**:
1. ç¢ºèªæ’ç¨‹æ¬Šé™æ­£ç¢ºï¼ˆç®¡ç†å“¡ï¼‰
2. æª¢æŸ¥ `scheduler.log` æŸ¥çœ‹éŒ¯èª¤è¨Šæ¯
3. æ‰‹å‹•æ¸¬è©¦ PowerShell è…³æœ¬ï¼š
   ```powershell
   .\run_automation.ps1
   ```

## ğŸ“ é–‹ç™¼æ–‡ä»¶

- [Function I/O Documentation](docs/function_io.md) - è©³ç´°çš„å‡½æ•¸è¼¸å…¥è¼¸å‡ºè¦æ ¼
- [Setup Scheduler Guide](SETUP_SCHEDULER.md) - Windows æ’ç¨‹è¨­å®šæ•™å­¸
- [Diagnosis Report](diagnosis_report.md) - ç™»å…¥å•é¡Œè¨ºæ–·å ±å‘Š
- [Sign-in Fix Report](signin_fix_report.md) - ç°½åˆ°åŠŸèƒ½ä¿®å¾©å ±å‘Š

## ğŸ§ª æ¸¬è©¦è…³æœ¬

```bash
# æ¸¬è©¦é€šçŸ¥ç³»çµ±
node test_notification.js

# æ¸¬è©¦æŠ½çåŠŸèƒ½
node test_lottery_feature.js
```

## âš ï¸ æ³¨æ„äº‹é …

1. **ä¸è¦åˆ†äº« .env æª”æ¡ˆ** - åŒ…å«æ‚¨çš„å¸³è™Ÿå¯†ç¢¼å’Œ API Key
2. **ä¸è¦æäº¤ cookies.json** - åŒ…å«ç™»å…¥ Session
3. **å®šæœŸæª¢æŸ¥æ—¥èªŒ** - ç¢ºä¿è‡ªå‹•åŒ–æ­£å¸¸é‹ä½œ
4. **API é…é¡** - Gemini API æœ‰å…è²»é¡åº¦é™åˆ¶

## ğŸ”’ å®‰å…¨æ€§

- âœ… æ•æ„Ÿè³‡è¨Šå„²å­˜æ–¼ `.env`ï¼ˆå·²åŠ å…¥ `.gitignore`ï¼‰
- âœ… Cookie ä¸æœƒæäº¤è‡³ç‰ˆæœ¬æ§åˆ¶
- âœ… æ—¥èªŒæª”æ¡ˆå·²æ’é™¤æ–¼ Git
- âœ… åŸå§‹ç¢¼ä¸­ç„¡ç¡¬ç·¨ç¢¼çš„å¸³è™Ÿå¯†ç¢¼

## ğŸ“œ æˆæ¬Š

MIT License - è©³è¦‹ [LICENSE](LICENSE)

## ğŸ¤ è²¢ç»

æ­¡è¿æäº¤ Issue æˆ– Pull Requestï¼

## ğŸ“ è¯çµ¡æ–¹å¼

å¦‚æœ‰å•é¡Œæˆ–å»ºè­°ï¼Œè«‹é–‹ Issue è¨è«–ã€‚

---

**å…è²¬è²æ˜**: æœ¬å°ˆæ¡ˆåƒ…ä¾›å­¸ç¿’èˆ‡å€‹äººä½¿ç”¨ã€‚è«‹éµå®ˆç¶²ç«™æœå‹™æ¢æ¬¾ï¼Œé¿å…éåº¦é »ç¹è«‹æ±‚ã€‚
